<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>File upload - jRna examples</title>
    <script lang="javascript" src="../lib/3rd-party/jquery.js"></script>
    <script lang="javascript" src="../lib/jRna.js"></script>
    <script lang="javascript" id="description">var descr = {"title":"File upload - jRna examples"}</script>
</head>
<body>
    <h1>File upload - jRna examples</h1>

    <!-- initial node to attach to -->
    <div id="root">
        <input type="file" class="jrna-file">
        <div class="jrna-info"></div>
        <pre class="jrna-display"></pre>
    </div>

    <div id="library" style="display: none">
        <div class="meta">
            <span class="jrna-key"></span>: <span class="jrna-value"></span>
        </div>
    </div>

    <!-- the script is here -->
    <script lang="javascript" id="main">
        "use strict";

        const meta = new jRna()
            .htmlFrom('#library .meta')
            .output("key")
            .output("value")
            .args('key', 'value');

        const rna = new jRna()
            .output("display")
            .element("info")
            .upload("file")
            .on( "file", "change", function() {
                const me = this;
                this.file( function(ret) {
                    me.info.html('');
                    meta.appendTo(me.info, {key: 'name', value: ret.name });
                    meta.appendTo(me.info, {key: 'size', value: ret.size });
                    meta.appendTo(me.info, {key: 'type', value: ret.type });
                    meta.appendTo(me.info, {key: 'last modified', value: new Date(ret.lastModified) });
                    me.display = ret.content;
                });
            })
            .attach('#root');
    </script>

    <!-- describe how to use the page, if needed -->
    <div id="usage">
    </div>
</body>
</html>
